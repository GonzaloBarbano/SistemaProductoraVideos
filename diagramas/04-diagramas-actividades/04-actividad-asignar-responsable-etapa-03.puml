@startuml
title Diagrama de Actividades – Asignar Responsable a Etapa
|Coordinador/Productor|
start

:Iniciar flujo "Asignar Responsable";
:Seleccionar proyecto y etapa;
:Elegir posible responsable;
:Solicitar validación de responsable;

|Sistema de Gestión|
:Recibir solicitud de validación;
:Verificar existencia del usuario;

if (Usuario existe?) then (no)
  :Informar error "Usuario no encontrado";
  |Coordinador/Productor|
  :Mostrar error;
  end
else (sí)
  :Verificar rol permitido para la etapa;
endif

if (Rol válido?) then (no)
  :Informar error "Rol no permitido";
  |Coordinador/Productor|
  :Mostrar error;
  end
else (sí)
  :Verificar estado del usuario;
endif

if (Usuario activo?) then (no)
  :Informar error "Usuario inactivo";
  |Coordinador/Productor|
  :Mostrar error;
  end
else (sí)
  :Determinar si es reasignación;
endif

|Sistema de Gestión|
if (Es reasignación?) then (sí)
  :Actualizar responsable en etapa;
  :Registrar historial de reasignación;
else (no)
  :Asignar responsable a etapa;
endif

|Coordinador/Productor|
:Recibir confirmación de asignación exitosa;
:Finalizar proceso;
stop
@enduml
